@model LeSan.HlxPortal.WebSite.Models.RadiationViewModel
@using Newtonsoft.Json;

<div class="demo-section k-content" style="min-height:1000px;height:100%">
    <div id="chartDose" style="margin-bottom:20px"></div>
    <div id="chartTemperature" style="margin-bottom:20px"></div>
</div>

<script type="text/javascript">
    var radiationDatas = @Html.Raw(JsonConvert.SerializeObject(Model.DataList));

    createDoseChart(radiationDatas);
    createTemperatureChart(radiationDatas);

    // use plc icon to represent binarys
    function createDoseChart(plotLines) {
        $('#chartDose').kendoChart({
            title: {
                text: "剂量数据",
            },
            legend: {
                position: "bottom",
            },
            dataSource: {
                data: plotLines
            },
            seriesDefaults: {
                type: "scatterLine",
                style: "smooth"
            },
            series: [{
                xField: "TimeStamp",
                yField: "Dose1",
                name: "探头1",
                markers: { visible: false, size: 4 }
            }, {
                xField: "TimeStamp",
                yField: "Dose2",
                name: "探头2",
                markers: { visible: false, size: 4 }
            }, {
                xField: "TimeStamp",
                yField: "Dose3",
                name: "探头3",
                markers: { visible: false, size: 4 }
            }, {
                xField: "TimeStamp",
                yField: "Dose4",
                name: "探头5",
                markers: { visible: false, size: 4 }
            }, {
                xField: "TimeStamp",
                yField: "Dose5",
                name: "探头5",
                markers: { visible: false, size: 4 }
            }],
            xAxis: {
                type: "date",
                baseUnit: "hours",
                labels: {
                    template: "#=kendo.toString(value, 'M/d H:mm')#"
                }
            },
            yAxis: {
                labels: {
                    format: "{0} uSv/h"
                }
            },
            tooltip: {
                visible: true,
                template: "#= series.name #<br/>X: #=kendo.toString(new Date(value.x), 'MM-dd HH:mm')#<br/>Y: #=value.y# uSv/h"
            }
        });
    }

    function createTemperatureChart(plotLines) {
        $('#chartTemperature').kendoChart({
            title: {
                text: "温湿度数据",
            },
            legend: {
                position: "bottom",
            },
            dataSource: {
                data: plotLines
            },
            seriesDefaults: {
                type: "scatterLine",
                style: "smooth"
            },
            series: [{
                xField: "TimeStamp",
                yField: "Temperature",
                name: "温度 [&deg;C]",
                markers: { visible: false, size: 4 }
            }, {
                xField: "TimeStamp",
                yField: "Humidity",
                name: "湿度 [%]",
                markers: { visible: false, size: 4 }
            }],
            xAxis: {
                type: "date",
                baseUnit: "hours",
                labels: {
                    template: "#=kendo.toString(value, 'M/d H:mm')#"
                }
            },
            tooltip: {
                visible: true,
                template: "#= series.name #<br/>X: #=kendo.toString(new Date(value.x), 'MM-dd HH:mm')#<br/>Y: #=value.y#"
            }
        });
    }

</script>